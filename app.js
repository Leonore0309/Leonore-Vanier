/* ========= I18N : dictionnaire FR/EN ========= */
const I18N = {
  fr: {
    "contact.inline": "TÃ©l : 06 79 10 75 93 â€¢ Email : leonore.vanier@gmail.com â€¢ Paris, Ãle-de-France â€¢ 170 cm",

    "section.photos": "Photos",
    "nav.bio": "Bio",
    "section.casting": "Informations casting",
    "toggle.more": "Afficher plus",
    "toggle.less": "Afficher moins",
    "section.theatre": "ThÃ©Ã¢tre",
    "section.films": "CinÃ©ma â€“ Courts mÃ©trages",
    "section.tv": "TÃ©lÃ©vision",
    "section.training": "Formations",
    "section.reel": "Bande dÃ©mo",

    "reel.open": "Lire la bande dÃ©mo",
    "reel.cover": "Bande dÃ©mo â€” miniature locale",

    "bio.quote": "\"Invente, imagine, suppose. Fouille dans ton esprit. Cherches-y quelque chose dâ€™Ã©trange, dâ€™insensÃ©, dâ€™horrible et dâ€™inouÃ¯. Une fatalitÃ© dont on soit Ã©bloui !\" [Ruy Blas, Victor Hugo]",

    "casting.langues.k": "Langues",
    "casting.langues.v": "Anglais (bilingue sans accent), Espagnol (avancÃ©), CorÃ©en, Italien (notions), FranÃ§ais (maternelle)",
    "casting.danses.k": "Danses",
    "casting.danses.v": "Pompons girls (compÃ©tition), Classique (trÃ¨s bon niveau), Modernâ€™Jazz (bon niveau)",
    "casting.musique.k": "Musique",
    "casting.musique.v": "Chant (Alto)",
    "casting.sport.k": "Sport",
    "casting.sport.v": "AthlÃ©tisme (semi-marathon), Ski (trÃ¨s bon niveau), Natation (bon niveau), KaratÃ© (bon niveau)",
    "casting.hobbies.k": "Hobbies",
    "casting.hobbies.v": "Couture, Poterie, ModÃ¨le photo",
    "casting.permis.k": "Permis",
    "casting.permis.v": "B",

    "theatre.item1": "LE BAIN â€“ Mise en scÃ¨ne Clara Kermarec â€“ ThÃ©Ã¢tre de La CroisÃ©e des Chemins â€“ RÃ´le principal - SÃ©lection \"Festival Travaux de Fin d'Etudes Cours Florent 25/26\"",
    "theatre.item2": "TRISTESSE ET JOIE DANS LA VIE DES GIRAFES â€“ Mise en scÃ¨ne Iona Vavasseur â€“ RÃ´le Judy Garland",
    "theatre.item3": "LE LEGS â€“ Mise en scÃ¨ne Alain de Bock â€“ ThÃ©Ã¢tre A LA FOLIE - RÃ´le d'Hortense",
    "theatre.item4": "LE MARIAGE DE FIGARO â€“ Mise en scÃ¨ne Sophie Lecarpentier â€“ RÃ´le La Comtesse",
    "theatre.item5": "LA BONNE Ã‚ME DU SE-TCHOUAN â€“ Mise en scÃ¨ne Xavier Bazin â€“ RÃ´le La Femme",
    "theatre.item6": "RING â€“ Mise en scÃ¨ne FrÃ©dÃ©rique Auger â€“ ThÃ©Ã¢tre Clavel â€“ RÃ´le La Femme",

    "films.item1": "Jâ€™EN TROUVERAI UN AUTRE â€“ RÃ©al. Louis Faudais â€“ RÃ´le principal (comÃ©die) - SÃ©lection \"1 min 2 court Festival\"",
    "films.item2": "LE DAHUT â€“ RÃ©al. LÃ©onore Vanier â€“ RÃ´le principal (comÃ©die) - SÃ©lection \"Prix Florent Image\"",
    "films.item3": "MASTERPROF â€“ RÃ©al. Jef Yomby â€“ Opango â€“ RÃ´le principal (comÃ©die)",

    "tv.item1": "VINCI AUTOROUTE â€“ RÃ©al. Charly â€“ Prod. Marie Gleyze & Sylvain Pouyet â€“ RÃ´le principal",
    "tv.item2": "ENGIE Solutions â€“ RÃ©al. 714 Prod â€“ RÃ´le principal",

    "training.item1": "2025 â€“ Stage Â« Intitation Ã  la transe Â» (ValÃ©rie De Dietrich) â€” Stage Systema (Laurent Joly) â€” Atelier coaching (Fabrice Luneau) â€” Open Badge : prÃ©venir et lutter contre les VHSS dans le cinÃ©ma",
    "training.item2": "2024-25 â€“ Cours Florent : AnnÃ©e 3 (Jerzy Klsyk, Sandy Boizard, Sophie Lecarpentier) â€” Stage Masque (Khadija El Mahdi) â€” Stage Impro (David Garel) â€” Stage casting (Emmanuelle Bourcy)",
    "training.item3": "2023-24 â€“ Cours Florent : AnnÃ©e 2 (Xavier Bazin)",
    "training.item4": "2022-23 â€“ Cours Florent : AnnÃ©e 1 (Olivier Augrond)",
    "training.item5": "2022 â€“ DiplÃ´me dâ€™ingÃ©nieur, National University of Singapore",

    "photos.epoque": "Ã‰poque",
    "photos.innocence": "Innocence",
    "photos.fatale": "Fatale",
    "photos.malice": "Malice",
    "photos.romantique": "Romantique",
    "photos.dynamique": "Dynamique",
    "photos.puissante": "Puissante",
    "photos.douceur": "Douceur",
    "photos.heroine_romantique": "HÃ©roÃ¯ne romantique",
    "photos.heroine_epoque": "HÃ©roÃ¯ne romantique Ã©poque",
    "photos.jeune_flic": "Jeune flic"
  },

  en: {
    "contact.inline": "Phone: +33 6 79 10 75 93 â€¢ Email: leonore.vanier@gmail.com â€¢ Paris, Ãle-de-France â€¢ 170 cm",

    "section.photos": "Photos",
    "nav.bio": "Bio",
    "section.casting": "Casting info",
    "toggle.more": "Show more",
    "toggle.less": "Show less",
    "section.theatre": "Theatre",
    "section.films": "Short films",
    "section.tv": "Television",
    "section.training": "Training",
    "section.reel": "Showreel",

    "reel.open": "Play the showreel",
    "reel.cover": "Showreel â€” local thumbnail",

    "bio.quote": "\"Invent, imagine, suppose. Search your mind for something strange, outrageous, terrible, unheard of! A dazzling twist of fate!\" [Ruy Blas, Victor Hugo]",

    "casting.langues.k": "Languages",
    "casting.langues.v": "English (bilingual, no accent), Spanish (advanced), Korean, Italian (basic), French (native)",
    "casting.danses.k": "Dance",
    "casting.danses.v": "Cheer dance (competition), Ballet (very good), Modern Jazz (good)",
    "casting.musique.k": "Music",
    "casting.musique.v": "Singing (Alto)",
    "casting.sport.k": "Sports",
    "casting.sport.v": "Athletics (half-marathon), Skiing (very good), Swimming (good), Karate (good)",
    "casting.hobbies.k": "Hobbies",
    "casting.hobbies.v": "Sewing, Pottery, Photo model",
    "casting.permis.k": "Driving license",
    "casting.permis.v": "B",

    "theatre.item1": "LE BAIN â€“ Dir. Clara Kermarec â€“ ThÃ©Ã¢tre de La CroisÃ©e des Chemins â€“ Lead role â€“ Selected \"Festival Travaux de Fin d'Etudes Cours Florent 25/26\"",
    "theatre.item2": "TRISTESSE ET JOIE DANS LA VIE DES GIRAFES â€“ Dir. Iona Vavasseur â€“ Role: Judy Garland",
    "theatre.item3": "LE LEGS â€“ Dir. Alain de Bock â€“ ThÃ©Ã¢tre A LA FOLIE â€“ Role: Hortense",
    "theatre.item4": "LE MARIAGE DE FIGARO â€“ Dir. Sophie Lecarpentier â€“ Role: The Countess",
    "theatre.item5": "LA BONNE Ã‚ME DU SE-TCHOUAN â€“ Dir. Xavier Bazin â€“ Role: Woman",
    "theatre.item6": "RING â€“ Dir. FrÃ©dÃ©rique Auger â€“ ThÃ©Ã¢tre Clavel â€“ Role: Woman",

    "films.item1": "I'LL FIND ANOTHER ONE â€“ Dir. Louis Faudais â€“ Lead (comedy) â€“ Selected \"1 min 2 court Festival\"",
    "films.item2": "LE DAHUT â€“ Dir. LÃ©onore Vanier â€“ Lead (comedy) â€“ Selected \"Prix Florent Image\"",
    "films.item3": "MASTERPROF â€“ Dir. Jef Yomby â€“ Opango â€“ Lead (comedy)",

    "tv.item1": "VINCI AUTOROUTE â€“ Dir. Charly â€“ Prod. Marie Gleyze & Sylvain Pouyet â€“ Lead",
    "tv.item2": "ENGIE Solutions â€“ Dir. 714 Prod â€“ Lead",

    "training.item1": "2025 â€“ \"Initiation to trance\" (ValÃ©rie De Dietrich) â€” Systema (Laurent Joly) â€” Coaching workshop (Fabrice Luneau) â€” VHSS badge",
    "training.item2": "2024-25 â€“ Cours Florent: Year 3 (Jerzy Klsyk, Sandy Boizard, Sophie Lecarpentier) â€” Mask (Khadija El Mahdi) â€” Improv (David Garel) â€” Casting (Emmanuelle Bourcy)",
    "training.item3": "2023-24 â€“ Cours Florent: Year 2 (Xavier Bazin)",
    "training.item4": "2022-23 â€“ Cours Florent: Year 1 (Olivier Augrond)",
    "training.item5": "2022 â€“ Engineering degree, National University of Singapore",

    "photos.epoque": "Period",
    "photos.innocence": "Innocence",
    "photos.fatale": "Femme fatale",
    "photos.malice": "Mischief",
    "photos.romantique": "Romantic",
    "photos.dynamique": "Dynamic",
    "photos.puissante": "Powerful",
    "photos.douceur": "Softness",
    "photos.heroine_romantique": "Romantic heroine",
    "photos.heroine_epoque": "Period romantic heroine",
    "photos.jeune_flic": "Young cop"
  }
};

/* ========= i18n : applique langue ========= */
function setLang(lang){
  localStorage.setItem('lang', lang);
  document.documentElement.setAttribute('lang', lang);

  // Textes simples
  document.querySelectorAll('[data-i18n]').forEach(el=>{
    const key = el.getAttribute('data-i18n');
    const text = I18N[lang]?.[key];
    if (typeof text === 'string') el.textContent = text;
  });

  // Attributs (ex: alt, aria-label) via data-i18n-attr="alt:key;aria-label:key2"
  document.querySelectorAll('[data-i18n-attr]').forEach(el=>{
    const defs = el.getAttribute('data-i18n-attr')
      .split(';').map(s=>s.trim()).filter(Boolean);
    defs.forEach(pair=>{
      const [attr, key] = pair.split(':').map(s=>s.trim());
      const val = I18N[lang]?.[key];
      if (attr && typeof val === 'string') el.setAttribute(attr, val);
    });
  });

  // Boutons FR/EN
  document.querySelectorAll('.lang-btn').forEach(btn=>{
    btn.setAttribute('aria-pressed', String(btn.dataset.lang === lang));
  });

  // Met Ã  jour le libellÃ© du toggle casting
  const list = document.getElementById('casting-list');
  const toggle = document.querySelector('.toggle-casting');
  if (list && toggle){
    const expanded = list.classList.contains('expanded');
    const tkey = expanded ? 'toggle.less' : 'toggle.more';
    toggle.textContent = I18N[lang][tkey] || toggle.textContent;
  }
}

/* ========= Casting : clamp + toggle ========= */
function initCastingClamp(){
  const list = document.getElementById('casting-list');
  if(!list) return;
  const rows = Array.from(list.querySelectorAll('.kv'));
  const toggle = document.querySelector('.toggle-casting');

  function apply(){
    const expanded = list.classList.contains('expanded');
    rows.forEach((row, i)=>{
      row.style.display = (expanded || i < 3) ? 'grid' : 'none';
    });
    const lang = localStorage.getItem('lang') || 'fr';
    toggle.textContent = I18N[lang]['toggle.'+(expanded?'less':'more')] || toggle.textContent;
  }

  if (toggle){
    toggle.addEventListener('click', (e)=>{
      e.preventDefault();
      list.classList.toggle('expanded');
      apply();
    });
  }
  apply();
}

/* ========= Lightbox ========= */
function initLightbox(){
  const links = Array.from(document.querySelectorAll('.gallery a'));
  if(!links.length) return;

  const lb = document.getElementById('lightbox');
  const img = document.getElementById('lb-img');
  const cap = document.getElementById('lb-caption');
  const btnPrev = lb.querySelector('.lb-prev');
  const btnNext = lb.querySelector('.lb-next');
  const btnClose = lb.querySelector('.lb-close');
  let idx = 0;

  const srcOf = (i)=> {
    const a = links[i];
    return a.getAttribute('href') || (a.querySelector('img') && a.querySelector('img').src);
  };
  const altOf = (i)=> {
    const im = links[i].querySelector('img');
    return (im && im.getAttribute('alt')) || '';
  };

  function open(i){ idx = i; update(); lb.classList.add('open'); lb.setAttribute('aria-hidden','false'); document.body.classList.add('lb-open'); }
  function close(){ lb.classList.remove('open'); lb.setAttribute('aria-hidden','true'); document.body.classList.remove('lb-open'); }
  function update(){ img.src = srcOf(idx); img.alt = altOf(idx); cap.textContent = img.alt || ''; }
  function next(){ idx = (idx + 1) % links.length; update(); }
  function prev(){ idx = (idx - 1 + links.length) % links.length; update(); }

  links.forEach((a,i)=>{
    a.addEventListener('click', (e)=>{ e.preventDefault(); open(i); });
  });
  btnNext.addEventListener('click', (e)=>{ e.stopPropagation(); next(); });
  btnPrev.addEventListener('click', (e)=>{ e.stopPropagation(); prev(); });
  btnClose.addEventListener('click', (e)=>{ e.stopPropagation(); close(); });

  document.addEventListener('keydown', (e)=>{
    if(!lb.classList.contains('open')) return;
    if(e.key === 'Escape') return close();
    if(e.key === 'ArrowRight') return next();
    if(e.key === 'ArrowLeft') return prev();
  });

  lb.addEventListener('click', (e)=>{
    if(e.target === lb){ close(); }
  });
}

/* ========= Init global ========= */
document.addEventListener('DOMContentLoaded', ()=>{
  // AnnÃ©e auto
  const yearEl = document.getElementById('year');
  if (yearEl) yearEl.textContent = new Date().getFullYear();

  // Langue initiale
  const saved = localStorage.getItem('lang') || 'fr';
  setLang(saved);

  // Boutons de langue
  document.querySelectorAll('.lang-btn').forEach(btn=>{
    btn.addEventListener('click', ()=> setLang(btn.dataset.lang));
  });

  // Modules
  initCastingClamp();
  initLightbox();
});

// Capture d'Ã©cran au clic sur le bouton
const snapBtn = document.getElementById('download-snap');
if (snapBtn) {
  snapBtn.addEventListener('click', async (e)=>{
    e.preventDefault();
    const element = document.body; // ou .container si tu veux uniquement le contenu central
    html2canvas(element, {useCORS:true, scale:2}).then(canvas=>{
      // RÃ©cupÃ©rer l'annÃ©e en cours
      const year = new Date().getFullYear();

      // Nom de fichier personnalisÃ©
      const filename = `CV artistique LÃ©onore Vanier - 06 79 10 75 93 - ${year}.png`;

      // TÃ©lÃ©charger
      const link = document.createElement('a');
      link.download = filename;
      link.href = canvas.toDataURL('image/png');
      link.click();
    }).catch(err=>{
      console.error("Erreur capture:", err);
      alert("La capture n'a pas pu Ãªtre gÃ©nÃ©rÃ©e ğŸ˜”");
    });
  });
}
